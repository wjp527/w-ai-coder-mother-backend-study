# @DubboReference æ³¨è§£è¯¦è§£

## ğŸ“š ç›®å½•
1. [ä»€ä¹ˆæ˜¯ @DubboReference](#ä»€ä¹ˆæ˜¯-dubboreference)
2. [æ ¸å¿ƒæ¦‚å¿µ](#æ ¸å¿ƒæ¦‚å¿µ)
3. [å·¥ä½œåŸç†è¯¦è§£](#å·¥ä½œåŸç†è¯¦è§£)
4. [å®Œæ•´æµç¨‹å›¾](#å®Œæ•´æµç¨‹å›¾)
5. [å®é™…ä»£ç ç¤ºä¾‹åˆ†æ](#å®é™…ä»£ç ç¤ºä¾‹åˆ†æ)
6. [å…³é”®é…ç½®è¯´æ˜](#å…³é”®é…ç½®è¯´æ˜)
7. [å¸¸è§é—®é¢˜è§£ç­”](#å¸¸è§é—®é¢˜è§£ç­”)

---

## ä»€ä¹ˆæ˜¯ @DubboReference

`@DubboReference` æ˜¯ Apache Dubbo æ¡†æ¶æä¾›çš„**æœåŠ¡æ¶ˆè´¹è€…æ³¨è§£**ï¼Œç”¨äºåœ¨å¾®æœåŠ¡æ¶æ„ä¸­**è‡ªåŠ¨æ³¨å…¥è¿œç¨‹æœåŠ¡çš„ä»£ç†å¯¹è±¡**ã€‚

### ç±»æ¯”ç†è§£
æƒ³è±¡ä¸€ä¸‹ï¼š
- **æœ¬åœ°æœåŠ¡è°ƒç”¨**ï¼šå°±åƒåœ¨åŒä¸€æ ‹æ¥¼é‡Œï¼Œä½ ç›´æ¥èµ°åˆ°éš”å£åŠå…¬å®¤æ‰¾äººåŠäº‹
- **Dubbo è¿œç¨‹è°ƒç”¨**ï¼šå°±åƒä½ åœ¨åŒ—äº¬ï¼Œéœ€è¦æ‰¾ä¸Šæµ·åŠå…¬å®¤çš„äººåŠäº‹ï¼Œä½†ä½ ä¸éœ€è¦äº²è‡ªå»ï¼Œåªéœ€è¦æ‰“ä¸ªç”µè¯ï¼ˆé€šè¿‡ä»£ç†å¯¹è±¡ï¼‰ï¼Œç”µè¯ä¼šè‡ªåŠ¨å¸®ä½ è”ç³»åˆ°ä¸Šæµ·çš„äºº

---

## æ ¸å¿ƒæ¦‚å¿µ

### 1. æœåŠ¡æä¾›è€…ï¼ˆProviderï¼‰
- **ä½œç”¨**ï¼š**æä¾›**å…·ä½“çš„ä¸šåŠ¡æœåŠ¡å®ç°
- **æ ‡è¯†**ï¼šä½¿ç”¨ `@DubboService` æ³¨è§£
- **ä½ç½®**ï¼šåœ¨æœåŠ¡æä¾›æ–¹ï¼ˆå¦‚ `wjp-ai-code-user` æ¨¡å—ï¼‰

```java
// æœåŠ¡æä¾›è€…ç¤ºä¾‹
@DubboService  // æ ‡è®°è¿™æ˜¯ä¸€ä¸ª Dubbo æœåŠ¡
public class InnerUserServiceImpl implements InnerUserService {
    // å®ç°å…·ä½“çš„ä¸šåŠ¡é€»è¾‘
    @Override
    public User getById(Serializable id) {
        return userService.getById(id);
    }
}
```

### 2. æœåŠ¡æ¶ˆè´¹è€…ï¼ˆConsumerï¼‰
- **ä½œç”¨**ï¼š**æ¶ˆè´¹**ï¼ˆä½¿ç”¨ï¼‰è¿œç¨‹æœåŠ¡
- **æ ‡è¯†**ï¼šä½¿ç”¨ `@DubboReference` æ³¨è§£
- **ä½ç½®**ï¼šåœ¨æœåŠ¡æ¶ˆè´¹æ–¹ï¼ˆå¦‚ `wjp-ai-code-app` æ¨¡å—ï¼‰

```java
// æœåŠ¡æ¶ˆè´¹è€…ç¤ºä¾‹
@Service
public class AppServiceImpl {
    @DubboReference(check = false)  // æ³¨å…¥è¿œç¨‹æœåŠ¡ä»£ç†
    private InnerUserService userService;  // è¿™ä¸ªå¯¹è±¡å®é™…ä¸Šæ˜¯ä»£ç†å¯¹è±¡
    
    public void someMethod() {
        // è°ƒç”¨æ—¶ï¼Œå®é™…æ˜¯é€šè¿‡ç½‘ç»œè°ƒç”¨è¿œç¨‹æœåŠ¡
        User user = userService.getById(123L);
    }
}
```

### 3. æ³¨å†Œä¸­å¿ƒï¼ˆRegistryï¼‰
- **ä½œç”¨**ï¼š**æœåŠ¡å‘ç°**å’Œ**æœåŠ¡æ³¨å†Œ**çš„ä¸­é—´äºº
- **å¸¸ç”¨**ï¼šNacosã€Zookeeperã€Consul ç­‰
- **åŠŸèƒ½**ï¼š
  - æœåŠ¡æä¾›è€…å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒ**æ³¨å†Œ**è‡ªå·±çš„æœåŠ¡ä¿¡æ¯
  - æœåŠ¡æ¶ˆè´¹è€…å¯åŠ¨æ—¶ï¼Œä»æ³¨å†Œä¸­å¿ƒ**è®¢é˜…**éœ€è¦çš„æœåŠ¡ä¿¡æ¯

---

## å·¥ä½œåŸç†è¯¦è§£

### é˜¶æ®µä¸€ï¼šæœåŠ¡å¯åŠ¨æ—¶çš„åˆå§‹åŒ–è¿‡ç¨‹

#### 1.1 æœåŠ¡æä¾›è€…å¯åŠ¨ï¼ˆProvider Startupï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æœåŠ¡æä¾›è€…å¯åŠ¨æµç¨‹ï¼ˆwjp-ai-code-user æ¨¡å—ï¼‰              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ­¥éª¤ 1: Spring å®¹å™¨æ‰«æåˆ° @DubboService
        â†“
æ­¥éª¤ 2: Dubbo æ¡†æ¶åˆ›å»ºæœåŠ¡å®ç°å¯¹è±¡
        â†“
æ­¥éª¤ 3: å°†æœåŠ¡ä¿¡æ¯æ³¨å†Œåˆ° Nacos æ³¨å†Œä¸­å¿ƒ
        â”‚
        â”‚ æ³¨å†Œä¿¡æ¯åŒ…æ‹¬ï¼š
        â”‚ - æœåŠ¡æ¥å£åç§°ï¼šInnerUserService
        â”‚ - æœåŠ¡æä¾›è€…åœ°å€ï¼š192.168.1.100:50051
        â”‚ - åè®®ç±»å‹ï¼štri (gRPC)
        â”‚ - ç‰ˆæœ¬å·ã€åˆ†ç»„ç­‰å…ƒæ•°æ®
        â†“
æ­¥éª¤ 4: å¯åŠ¨ç½‘ç»œæœåŠ¡ï¼Œç›‘å¬ç«¯å£ 50051
        â†“
æ­¥éª¤ 5: æœåŠ¡æä¾›è€…å°±ç»ªï¼Œç­‰å¾…è¿œç¨‹è°ƒç”¨
```

**å›¾è§£ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  InnerUserServiceImplâ”‚  â† @DubboService æ ‡è®°
â”‚  (æœåŠ¡å®ç°ç±»)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ å®ç°
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  InnerUserService   â”‚  â† æœåŠ¡æ¥å£
â”‚  (æ¥å£å®šä¹‰)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ æ³¨å†Œ
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Nacos æ³¨å†Œä¸­å¿ƒ â”‚  â† å­˜å‚¨æœåŠ¡ä¿¡æ¯
    â”‚  127.0.0.1:8848â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 1.2 æœåŠ¡æ¶ˆè´¹è€…å¯åŠ¨ï¼ˆConsumer Startupï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æœåŠ¡æ¶ˆè´¹è€…å¯åŠ¨æµç¨‹ï¼ˆwjp-ai-code-app æ¨¡å—ï¼‰                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ­¥éª¤ 1: Spring å®¹å™¨æ‰«æåˆ° @DubboReference
        â†“
æ­¥éª¤ 2: Dubbo æ¡†æ¶å‘ç°éœ€è¦æ³¨å…¥è¿œç¨‹æœåŠ¡
        â†“
æ­¥éª¤ 3: ä» Nacos æ³¨å†Œä¸­å¿ƒæŸ¥æ‰¾æœåŠ¡æä¾›è€…
        â”‚
        â”‚ æŸ¥è¯¢æ¡ä»¶ï¼š
        â”‚ - æœåŠ¡æ¥å£ï¼šInnerUserService
        â”‚ - ç‰ˆæœ¬å·ã€åˆ†ç»„ç­‰
        â†“
æ­¥éª¤ 4: è·å–æœåŠ¡æä¾›è€…åœ°å€åˆ—è¡¨
        â”‚
        â”‚ ä¾‹å¦‚ï¼š
        â”‚ - 192.168.1.100:50051
        â”‚ - 192.168.1.101:50051 (å¦‚æœæœ‰å¤šä¸ªæä¾›è€…)
        â†“
æ­¥éª¤ 5: åˆ›å»ºåŠ¨æ€ä»£ç†å¯¹è±¡
        â”‚
        â”‚ ä»£ç†å¯¹è±¡ç‰¹ç‚¹ï¼š
        â”‚ - å®ç°äº† InnerUserService æ¥å£
        â”‚ - å†…éƒ¨åŒ…å«ç½‘ç»œé€šä¿¡é€»è¾‘
        â”‚ - å¯¹å¼€å‘è€…é€æ˜ï¼Œä½¿ç”¨èµ·æ¥åƒæœ¬åœ°å¯¹è±¡
        â†“
æ­¥éª¤ 6: å°†ä»£ç†å¯¹è±¡æ³¨å…¥åˆ° @DubboReference æ ‡è®°çš„å­—æ®µ
        â†“
æ­¥éª¤ 7: æœåŠ¡æ¶ˆè´¹è€…å°±ç»ª
```

**å›¾è§£ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AppServiceImpl       â”‚
â”‚                       â”‚
â”‚  @DubboReference      â”‚  â† éœ€è¦æ³¨å…¥è¿œç¨‹æœåŠ¡
â”‚  InnerUserService     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ æŸ¥æ‰¾æœåŠ¡
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Nacos æ³¨å†Œä¸­å¿ƒ â”‚  â† æŸ¥è¯¢æœåŠ¡æä¾›è€…
    â”‚  127.0.0.1:8848â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ è¿”å›æœåŠ¡åœ°å€
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Dubbo æ¡†æ¶         â”‚
â”‚  åˆ›å»ºåŠ¨æ€ä»£ç†å¯¹è±¡    â”‚  â† å…³é”®æ­¥éª¤ï¼
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ æ³¨å…¥
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä»£ç†å¯¹è±¡            â”‚
â”‚  (çœ‹èµ·æ¥åƒæœ¬åœ°å¯¹è±¡ï¼Œ  â”‚
â”‚   å®é™…æ˜¯è¿œç¨‹è°ƒç”¨)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### é˜¶æ®µäºŒï¼šæ–¹æ³•è°ƒç”¨æ—¶çš„æ‰§è¡Œè¿‡ç¨‹

å½“ä½ åœ¨ä»£ç ä¸­è°ƒç”¨ `userService.getById(123L)` æ—¶ï¼Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

#### è¯¦ç»†æ‰§è¡Œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ–¹æ³•è°ƒç”¨æ‰§è¡Œæµç¨‹                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ­¥éª¤ 1: ä»£ç è°ƒç”¨
        userService.getById(123L)
        â†“
æ­¥éª¤ 2: å®é™…è°ƒç”¨çš„æ˜¯ä»£ç†å¯¹è±¡çš„æ–¹æ³•
        â†“
æ­¥éª¤ 3: ä»£ç†å¯¹è±¡æ‹¦æˆªæ–¹æ³•è°ƒç”¨
        â”‚
        â”‚ ä»£ç†å¯¹è±¡å†…éƒ¨æ“ä½œï¼š
        â”‚ - åºåˆ—åŒ–å‚æ•°ï¼šå°† 123L è½¬æ¢ä¸ºç½‘ç»œä¼ è¾“æ ¼å¼
        â”‚ - æ„å»ºè¯·æ±‚ï¼šåˆ›å»º RPC è¯·æ±‚å¯¹è±¡
        â”‚ - é€‰æ‹©æœåŠ¡æä¾›è€…ï¼šä»å¤šä¸ªæä¾›è€…ä¸­é€‰æ‹©ä¸€ä¸ªï¼ˆè´Ÿè½½å‡è¡¡ï¼‰
        â†“
æ­¥éª¤ 4: é€šè¿‡ç½‘ç»œå‘é€è¯·æ±‚
        â”‚
        â”‚ ç½‘ç»œä¼ è¾“ï¼š
        â”‚ - åè®®ï¼štri (gRPC)
        â”‚ - ç›®æ ‡åœ°å€ï¼š192.168.1.100:50051
        â”‚ - è¯·æ±‚å†…å®¹ï¼šæ–¹æ³•åã€å‚æ•°ç­‰
        â†“
æ­¥éª¤ 5: æœåŠ¡æä¾›è€…æ¥æ”¶è¯·æ±‚
        â”‚
        â”‚ æä¾›è€…å¤„ç†ï¼š
        â”‚ - ååºåˆ—åŒ–å‚æ•°ï¼šå°†ç½‘ç»œæ ¼å¼è½¬æ¢ä¸º Java å¯¹è±¡
        â”‚ - è·¯ç”±åˆ°å…·ä½“å®ç°ï¼šæ‰¾åˆ° InnerUserServiceImpl
        â”‚ - è°ƒç”¨å®é™…æ–¹æ³•ï¼šæ‰§è¡Œ getById(123L)
        â†“
æ­¥éª¤ 6: æ‰§è¡Œä¸šåŠ¡é€»è¾‘
        â”‚
        â”‚ ä¾‹å¦‚ï¼šæŸ¥è¯¢æ•°æ®åº“
        â”‚ SELECT * FROM user WHERE id = 123
        â†“
æ­¥éª¤ 7: è¿”å›ç»“æœ
        â”‚
        â”‚ æä¾›è€…æ“ä½œï¼š
        â”‚ - åºåˆ—åŒ–ç»“æœï¼šå°† User å¯¹è±¡è½¬æ¢ä¸ºç½‘ç»œæ ¼å¼
        â”‚ - é€šè¿‡ç½‘ç»œè¿”å›å“åº”
        â†“
æ­¥éª¤ 8: æ¶ˆè´¹è€…æ¥æ”¶å“åº”
        â”‚
        â”‚ ä»£ç†å¯¹è±¡å¤„ç†ï¼š
        â”‚ - ååºåˆ—åŒ–ç»“æœï¼šå°†ç½‘ç»œæ ¼å¼è½¬æ¢ä¸º User å¯¹è±¡
        â”‚ - è¿”å›ç»™è°ƒç”¨æ–¹
        â†“
æ­¥éª¤ 9: ä»£ç ç»§ç»­æ‰§è¡Œ
        User user = ... (å¾—åˆ°ç»“æœ)
```

**å®Œæ•´æµç¨‹å›¾ï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ–¹æ³•è°ƒç”¨å®Œæ•´æµç¨‹å›¾                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ã€æ¶ˆè´¹è€…ç«¯ - wjp-ai-code-appã€‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AppServiceImpl  â”‚
â”‚                 â”‚
â”‚ userService     â”‚â”€â”€â”
â”‚ .getById(123L)  â”‚  â”‚ â‘  ä»£ç è°ƒç”¨
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                      â†“
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  ä»£ç†å¯¹è±¡      â”‚
              â”‚  (Proxy)      â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ â‘¡ æ‹¦æˆªè°ƒç”¨
                      â†“
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  åºåˆ—åŒ–å‚æ•°    â”‚
              â”‚  123L â†’ bytes â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ â‘¢ æ„å»ºè¯·æ±‚
                      â†“
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  è´Ÿè½½å‡è¡¡é€‰æ‹©  â”‚
              â”‚  é€‰æ‹©æä¾›è€…    â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ â‘£ ç½‘ç»œä¼ è¾“
                      â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚     ç½‘ç»œä¼ è¾“å±‚ (tri/gRPC)   â”‚
        â”‚  192.168.1.100:50051       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â†“
ã€æä¾›è€…ç«¯ - wjp-ai-code-userã€‘
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  æ¥æ”¶ç½‘ç»œè¯·æ±‚  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ â‘¤ ååºåˆ—åŒ–
                      â†“
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  ååºåˆ—åŒ–å‚æ•°  â”‚
              â”‚  bytes â†’ 123L â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ â‘¥ è·¯ç”±åˆ°å®ç°
                      â†“
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚InnerUserServiceâ”‚
              â”‚    Impl        â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ â‘¦ æ‰§è¡Œä¸šåŠ¡é€»è¾‘
                      â†“
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  æŸ¥è¯¢æ•°æ®åº“    â”‚
              â”‚  SELECT ...   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ â‘§ å¾—åˆ°ç»“æœ
                      â†“
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  åºåˆ—åŒ–ç»“æœ    â”‚
              â”‚  User â†’ bytes â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ â‘¨ ç½‘ç»œè¿”å›
                      â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚     ç½‘ç»œä¼ è¾“å±‚ (tri/gRPC)   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â†“
ã€æ¶ˆè´¹è€…ç«¯ - wjp-ai-code-appã€‘
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  æ¥æ”¶å“åº”      â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ â‘© ååºåˆ—åŒ–
                      â†“
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  ååºåˆ—åŒ–ç»“æœ  â”‚
              â”‚  bytes â†’ User â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ â‘ª è¿”å›ç»™è°ƒç”¨æ–¹
                      â†“
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  ä»£ç ç»§ç»­æ‰§è¡Œ  â”‚
              â”‚  User user =  â”‚
              â”‚  ...         â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å®Œæ•´æµç¨‹å›¾

### ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Dubbo å¾®æœåŠ¡æ¶æ„å›¾                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Nacos æ³¨å†Œä¸­å¿ƒ  â”‚
                    â”‚  127.0.0.1:8848 â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                     â”‚
                    â”‚  æœåŠ¡æ³¨å†Œ/å‘ç°      â”‚
                    â”‚                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                      â”‚  â”‚                â”‚
        â”‚  æœåŠ¡æä¾›è€…          â”‚  â”‚  æœåŠ¡æ¶ˆè´¹è€…     â”‚
        â”‚  (Provider)          â”‚  â”‚  (Consumer)     â”‚
        â”‚                      â”‚  â”‚                â”‚
        â”‚  wjp-ai-code-user    â”‚  â”‚  wjp-ai-code-appâ”‚
        â”‚                      â”‚  â”‚                â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
        â”‚  â”‚@DubboService   â”‚  â”‚  â”‚  â”‚@DubboRefâ”‚  â”‚
        â”‚  â”‚InnerUserServiceâ”‚  â”‚  â”‚  â”‚erence    â”‚  â”‚
        â”‚  â”‚Impl            â”‚  â”‚  â”‚  â”‚userServiceâ”‚ â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚
        â”‚           â”‚          â”‚  â”‚       â”‚        â”‚
        â”‚           â”‚ å®ç°     â”‚  â”‚       â”‚ æ³¨å…¥   â”‚
        â”‚           â”‚          â”‚  â”‚       â”‚        â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”  â”‚
        â”‚  â”‚InnerUserServiceâ”‚  â”‚  â”‚  â”‚  ä»£ç†å¯¹è±¡ â”‚  â”‚
        â”‚  â”‚(æ¥å£)          â”‚  â”‚  â”‚  â”‚ (Proxy)  â”‚  â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚
        â”‚                       â”‚  â”‚       â”‚        â”‚
        â”‚  ç«¯å£: 50051          â”‚  â”‚       â”‚ RPCè°ƒç”¨â”‚
        â”‚  åè®®: tri            â”‚  â”‚       â”‚        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚       â”‚        â”‚
                                   â”‚       â†“        â”‚
                                   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                                   â”‚  â”‚ ç½‘ç»œä¼ è¾“  â”‚  â”‚
                                   â”‚  â”‚ tri/gRPC â”‚  â”‚
                                   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ—¶åºå›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ¶ˆè´¹è€…åº”ç”¨   â”‚      â”‚  Dubboæ¡†æ¶    â”‚      â”‚  Nacosæ³¨å†Œä¸­å¿ƒâ”‚      â”‚  æä¾›è€…åº”ç”¨   â”‚
â”‚  (App)       â”‚      â”‚              â”‚      â”‚              â”‚      â”‚  (User)      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                     â”‚                     â”‚                     â”‚
       â”‚  1.å¯åŠ¨åº”ç”¨          â”‚                     â”‚                     â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                     â”‚                     â”‚
       â”‚                     â”‚                     â”‚                     â”‚
       â”‚  2.æ‰«æ@DubboReferenceâ”‚                     â”‚                     â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                     â”‚                     â”‚
       â”‚                     â”‚                     â”‚                     â”‚
       â”‚                     â”‚  3.è®¢é˜…æœåŠ¡         â”‚                     â”‚
       â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                     â”‚
       â”‚                     â”‚                     â”‚                     â”‚
       â”‚                     â”‚                     â”‚  4.æ³¨å†ŒæœåŠ¡         â”‚
       â”‚                     â”‚                     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                     â”‚                     â”‚                     â”‚
       â”‚                     â”‚  5.è¿”å›æœåŠ¡åœ°å€     â”‚                     â”‚
       â”‚                     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚
       â”‚                     â”‚                     â”‚                     â”‚
       â”‚  6.åˆ›å»ºä»£ç†å¯¹è±¡      â”‚                     â”‚                     â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚                     â”‚
       â”‚                     â”‚                     â”‚                     â”‚
       â”‚  7.æ³¨å…¥ä»£ç†å¯¹è±¡      â”‚                     â”‚                     â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚                     â”‚
       â”‚                     â”‚                     â”‚                     â”‚
       â”‚  8.è°ƒç”¨æ–¹æ³•          â”‚                     â”‚                     â”‚
       â”‚  userService.getByIdâ”‚                     â”‚                     â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                     â”‚                     â”‚
       â”‚                     â”‚                     â”‚                     â”‚
       â”‚                     â”‚  9.RPCè¯·æ±‚          â”‚                     â”‚
       â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                     â”‚                     â”‚                     â”‚
       â”‚                     â”‚                     â”‚  10.æ‰§è¡Œä¸šåŠ¡é€»è¾‘    â”‚
       â”‚                     â”‚                     â”‚                     â”‚
       â”‚                     â”‚  11.RPCå“åº”         â”‚                     â”‚
       â”‚                     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                     â”‚                     â”‚                     â”‚
       â”‚  12.è¿”å›ç»“æœ         â”‚                     â”‚                     â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚                     â”‚
       â”‚                     â”‚                     â”‚                     â”‚
```

---

## å®é™…ä»£ç ç¤ºä¾‹åˆ†æ

### ç¤ºä¾‹ 1ï¼šAppServiceImpl ä¸­çš„ä½¿ç”¨

```java
@Service
@Slf4j
public class AppServiceImpl extends ServiceImpl<AppMapper, App> implements AppService {

    // ğŸ‘‡ è¿™é‡Œä½¿ç”¨äº† @DubboReference
    @DubboReference(check = false)
    private InnerUserService userService;  // è¿™ä¸ªå­—æ®µå®é™…ä¸Šæ˜¯ä¸€ä¸ªä»£ç†å¯¹è±¡

    @Override
    public AppVO getAppVO(App app) {
        // ... å…¶ä»–ä»£ç  ...
        
        // ğŸ‘‡ è¿™é‡Œè°ƒç”¨æ–¹æ³•æ—¶ï¼Œå®é™…å‘ç”Ÿçš„æ˜¯è¿œç¨‹è°ƒç”¨
        Long userId = app.getUserId();
        if (userId != null) {
            // çœ‹èµ·æ¥åƒæœ¬åœ°è°ƒç”¨ï¼Œå®é™…ä¸Šæ˜¯è¿œç¨‹ RPC è°ƒç”¨
            User user = userService.getById(userId);  // â† è¿œç¨‹è°ƒç”¨ï¼
            UserVO userVO = userService.getUserVO(user);  // â† è¿œç¨‹è°ƒç”¨ï¼
            appVO.setUser(userVO);
        }
        return appVO;
    }
}
```

**æ‰§è¡Œè¿‡ç¨‹å›¾è§£ï¼š**

```
ä»£ç æ‰§è¡Œï¼šuserService.getById(userId)
    â”‚
    â”œâ”€â†’ ä½ ä»¥ä¸ºï¼šç›´æ¥è°ƒç”¨æœ¬åœ°å¯¹è±¡çš„æ–¹æ³•
    â”‚
    â””â”€â†’ å®é™…ä¸Šï¼š
        â”‚
        â”œâ”€â†’ â‘  ä»£ç†å¯¹è±¡æ‹¦æˆªè°ƒç”¨
        â”‚
        â”œâ”€â†’ â‘¡ åºåˆ—åŒ–å‚æ•° userId
        â”‚
        â”œâ”€â†’ â‘¢ é€šè¿‡ç½‘ç»œå‘é€åˆ° wjp-ai-code-user æœåŠ¡
        â”‚     åœ°å€ï¼š192.168.1.100:50051
        â”‚
        â”œâ”€â†’ â‘£ wjp-ai-code-user æœåŠ¡æ¥æ”¶è¯·æ±‚
        â”‚
        â”œâ”€â†’ â‘¤ æ‰§è¡Œ InnerUserServiceImpl.getById()
        â”‚     æŸ¥è¯¢æ•°æ®åº“
        â”‚
        â”œâ”€â†’ â‘¥ åºåˆ—åŒ–ç»“æœ User å¯¹è±¡
        â”‚
        â”œâ”€â†’ â‘¦ é€šè¿‡ç½‘ç»œè¿”å›ç»“æœ
        â”‚
        â””â”€â†’ â‘§ ä»£ç†å¯¹è±¡æ¥æ”¶ç»“æœï¼Œè¿”å›ç»™è°ƒç”¨æ–¹
```

### ç¤ºä¾‹ 2ï¼šå¤šä¸ªæœåŠ¡å¼•ç”¨

```java
@Service
public class AppServiceImpl {
    
    // å¼•ç”¨ç”¨æˆ·æœåŠ¡
    @DubboReference(check = false)
    private InnerUserService userService;
    
    // å¼•ç”¨æˆªå›¾æœåŠ¡
    @DubboReference(check = false)
    private InnerScreenshotService screenshotService;
    
    public void generateAppScreenshotAsync(Long appId, String appDeployUrl) {
        // è°ƒç”¨è¿œç¨‹æˆªå›¾æœåŠ¡
        String screenshotUrl = screenshotService.generateAndUploadScreenshot(appDeployUrl);
        // ...
    }
}
```

**å¤šæœåŠ¡è°ƒç”¨å›¾è§£ï¼š**

```
AppServiceImpl
    â”‚
    â”œâ”€â†’ @DubboReference â†’ InnerUserService
    â”‚                      â”‚
    â”‚                      â””â”€â†’ ä»£ç†å¯¹è±¡1 â†’ wjp-ai-code-user:50051
    â”‚
    â””â”€â†’ @DubboReference â†’ InnerScreenshotService
                          â”‚
                          â””â”€â†’ ä»£ç†å¯¹è±¡2 â†’ wjp-ai-code-screenshot:50051
```

---

## å…³é”®é…ç½®è¯´æ˜

### 1. @DubboReference å¸¸ç”¨å±æ€§

```java
@DubboReference(
    check = false,              // å¯åŠ¨æ—¶ä¸æ£€æŸ¥æœåŠ¡æä¾›è€…æ˜¯å¦å¯ç”¨
    timeout = 3000,             // è°ƒç”¨è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
    retries = 2,                // å¤±è´¥é‡è¯•æ¬¡æ•°
    version = "1.0.0",          // æœåŠ¡ç‰ˆæœ¬
    group = "default",          // æœåŠ¡åˆ†ç»„
    loadbalance = "roundrobin"  // è´Ÿè½½å‡è¡¡ç­–ç•¥
)
private InnerUserService userService;
```

### 2. application.yml é…ç½®

```yaml
dubbo:
  registry:
    # æ³¨å†Œä¸­å¿ƒåœ°å€ï¼ˆNacosï¼‰
    address: nacos://127.0.0.1:8848?username=nacos&password=nacos
    register-mode: instance
  protocol:
    name: tri          # ä½¿ç”¨ tri åè®®ï¼ˆgRPCï¼‰
    port: 50051        # æœåŠ¡æä¾›è€…ç«¯å£
  consumer:
    timeout: 60000     # æ¶ˆè´¹è€…é»˜è®¤è¶…æ—¶æ—¶é—´
  provider:
    timeout: 60000     # æä¾›è€…é»˜è®¤è¶…æ—¶æ—¶é—´
```

### 3. é…ç½®è¯´æ˜å›¾è§£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Dubbo é…ç½®å±‚æ¬¡ç»“æ„               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

application.yml (å…¨å±€é…ç½®)
    â”‚
    â”œâ”€â†’ registry.address
    â”‚   â””â”€â†’ å‘Šè¯‰ Dubboï¼šå»å“ªé‡Œæ‰¾æœåŠ¡ï¼Ÿ
    â”‚       ç­”æ¡ˆï¼šNacos (127.0.0.1:8848)
    â”‚
    â”œâ”€â†’ protocol.name
    â”‚   â””â”€â†’ å‘Šè¯‰ Dubboï¼šç”¨ä»€ä¹ˆåè®®é€šä¿¡ï¼Ÿ
    â”‚       ç­”æ¡ˆï¼štri (gRPC)
    â”‚
    â”œâ”€â†’ protocol.port
    â”‚   â””â”€â†’ å‘Šè¯‰ Dubboï¼šæœåŠ¡æä¾›è€…ç›‘å¬å“ªä¸ªç«¯å£ï¼Ÿ
    â”‚       ç­”æ¡ˆï¼š50051
    â”‚
    â””â”€â†’ consumer.timeout
        â””â”€â†’ å‘Šè¯‰ Dubboï¼šè°ƒç”¨è¶…æ—¶æ—¶é—´ï¼Ÿ
            ç­”æ¡ˆï¼š60000 æ¯«ç§’
```

---

## å¸¸è§é—®é¢˜è§£ç­”

### Q1: ä¸ºä»€ä¹ˆä½¿ç”¨ @DubboReference è€Œä¸æ˜¯ç›´æ¥ new å¯¹è±¡ï¼Ÿ

**A:** 
- **ç›´æ¥ new**ï¼šåªèƒ½è°ƒç”¨æœ¬åœ°ä»£ç ï¼Œæ— æ³•è·¨æœåŠ¡è°ƒç”¨
- **@DubboReference**ï¼šè‡ªåŠ¨åˆ›å»ºä»£ç†å¯¹è±¡ï¼Œå¯ä»¥è°ƒç”¨è¿œç¨‹æœåŠ¡

```
âŒ é”™è¯¯æ–¹å¼ï¼š
InnerUserService userService = new InnerUserServiceImpl();
// è¿™æ ·åªèƒ½è°ƒç”¨æœ¬åœ°å®ç°ï¼Œæ— æ³•è·¨æœåŠ¡

âœ… æ­£ç¡®æ–¹å¼ï¼š
@DubboReference
private InnerUserService userService;
// è‡ªåŠ¨æ³¨å…¥ä»£ç†å¯¹è±¡ï¼Œå¯ä»¥è°ƒç”¨è¿œç¨‹æœåŠ¡
```

### Q2: ä»£ç†å¯¹è±¡æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆæˆ‘çœ‹ä¸åˆ°å®ƒï¼Ÿ

**A:** 
ä»£ç†å¯¹è±¡æ˜¯ Dubbo æ¡†æ¶åœ¨è¿è¡Œæ—¶åŠ¨æ€åˆ›å»ºçš„ï¼Œå®ƒï¼š
- **å®ç°äº†** `InnerUserService` æ¥å£
- **å†…éƒ¨åŒ…å«**ç½‘ç»œé€šä¿¡é€»è¾‘
- **å¯¹å¼€å‘è€…é€æ˜**ï¼Œä½¿ç”¨èµ·æ¥å’Œæ™®é€šå¯¹è±¡ä¸€æ ·

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä»£ç†å¯¹è±¡çš„å†…éƒ¨ç»“æ„ï¼ˆç®€åŒ–ï¼‰            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä»£ç†å¯¹è±¡ (Proxy)
    â”‚
    â”œâ”€â†’ å®ç° InnerUserService æ¥å£
    â”‚
    â”œâ”€â†’ åŒ…å«æœåŠ¡æä¾›è€…åœ°å€åˆ—è¡¨
    â”‚   [192.168.1.100:50051, ...]
    â”‚
    â”œâ”€â†’ åŒ…å«åºåˆ—åŒ–/ååºåˆ—åŒ–å™¨
    â”‚   (å°†å¯¹è±¡è½¬ä¸ºç½‘ç»œæ ¼å¼)
    â”‚
    â”œâ”€â†’ åŒ…å«è´Ÿè½½å‡è¡¡ç­–ç•¥
    â”‚   (é€‰æ‹©å“ªä¸ªæä¾›è€…)
    â”‚
    â””â”€â†’ åŒ…å«ç½‘ç»œé€šä¿¡å®¢æˆ·ç«¯
        (å‘é€/æ¥æ”¶ç½‘ç»œè¯·æ±‚)
```

### Q3: check = false æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ

**A:** 
- `check = true`ï¼ˆé»˜è®¤ï¼‰ï¼šå¯åŠ¨æ—¶æ£€æŸ¥æœåŠ¡æä¾›è€…æ˜¯å¦å¯ç”¨ï¼Œå¦‚æœä¸å¯ç”¨åˆ™å¯åŠ¨å¤±è´¥
- `check = false`ï¼šå¯åŠ¨æ—¶ä¸æ£€æŸ¥ï¼Œå³ä½¿æœåŠ¡æä¾›è€…æš‚æ—¶ä¸å¯ç”¨ä¹Ÿèƒ½å¯åŠ¨

```
check = true:
    å¯åŠ¨æ—¶ â†’ æ£€æŸ¥æœåŠ¡æä¾›è€… â†’ ä¸å¯ç”¨ â†’ âŒ å¯åŠ¨å¤±è´¥

check = false:
    å¯åŠ¨æ—¶ â†’ ä¸æ£€æŸ¥ â†’ âœ… å¯åŠ¨æˆåŠŸ
    è°ƒç”¨æ—¶ â†’ å¦‚æœæä¾›è€…ä¸å¯ç”¨ â†’ æŠ›å‡ºå¼‚å¸¸
```

### Q4: å¦‚æœæœåŠ¡æä¾›è€…æœ‰å¤šä¸ªå®ä¾‹ï¼Œä¼šè°ƒç”¨å“ªä¸ªï¼Ÿ

**A:** 
Dubbo ä¼šæ ¹æ®**è´Ÿè½½å‡è¡¡ç­–ç•¥**é€‰æ‹©ä¸€ä¸ªå®ä¾‹ï¼š

```
æœåŠ¡æä¾›è€…åˆ—è¡¨ï¼š
    - 192.168.1.100:50051 (å®ä¾‹1)
    - 192.168.1.101:50051 (å®ä¾‹2)
    - 192.168.1.102:50051 (å®ä¾‹3)

è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼š
    - roundrobinï¼ˆè½®è¯¢ï¼‰ï¼š1 â†’ 2 â†’ 3 â†’ 1 â†’ 2 â†’ 3 ...
    - randomï¼ˆéšæœºï¼‰ï¼šéšæœºé€‰æ‹©ä¸€ä¸ª
    - leastactiveï¼ˆæœ€å°‘æ´»è·ƒï¼‰ï¼šé€‰æ‹©è°ƒç”¨æœ€å°‘çš„
    - consistenthashï¼ˆä¸€è‡´æ€§å“ˆå¸Œï¼‰ï¼šæ ¹æ®å‚æ•°å“ˆå¸Œé€‰æ‹©
```

### Q5: è°ƒç”¨è¿œç¨‹æœåŠ¡ä¼šä¸ä¼šå¾ˆæ…¢ï¼Ÿ

**A:** 
- **æœ¬åœ°è°ƒç”¨**ï¼šé€šå¸¸ < 1 æ¯«ç§’
- **è¿œç¨‹è°ƒç”¨**ï¼šé€šå¸¸ 1-10 æ¯«ç§’ï¼ˆå–å†³äºç½‘ç»œå»¶è¿Ÿï¼‰

```
æ€§èƒ½å¯¹æ¯”ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   è°ƒç”¨ç±»å‹   â”‚   å»¶è¿Ÿæ—¶é—´    â”‚   è¯´æ˜       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æœ¬åœ°è°ƒç”¨    â”‚  < 1ms      â”‚  åŒä¸€è¿›ç¨‹å†…   â”‚
â”‚  è¿œç¨‹è°ƒç”¨    â”‚  1-10ms     â”‚  ç½‘ç»œä¼ è¾“     â”‚
â”‚  æ•°æ®åº“æŸ¥è¯¢  â”‚  5-50ms     â”‚  I/O æ“ä½œ    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¼˜åŒ–å»ºè®®ï¼š
1. ä½¿ç”¨å¼‚æ­¥è°ƒç”¨ï¼ˆä¸ç­‰å¾…ç»“æœï¼‰
2. æ‰¹é‡è°ƒç”¨ï¼ˆä¸€æ¬¡è°ƒç”¨å¤šä¸ªæ–¹æ³•ï¼‰
3. åˆç†è®¾ç½®è¶…æ—¶æ—¶é—´
```

### Q6: å¦‚æœè¿œç¨‹æœåŠ¡æŒ‚äº†æ€ä¹ˆåŠï¼Ÿ

**A:** 
Dubbo æä¾›äº†å¤šç§å®¹é”™æœºåˆ¶ï¼š

```
å®¹é”™ç­–ç•¥ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç­–ç•¥       â”‚   è¯´æ˜                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  failfast    â”‚ å¿«é€Ÿå¤±è´¥ï¼Œç«‹å³æŠ›å‡ºå¼‚å¸¸         â”‚
â”‚  failsafe    â”‚ å¤±è´¥å®‰å…¨ï¼Œå¿½ç•¥å¼‚å¸¸ï¼Œè¿”å›ç©º    â”‚
â”‚  failover    â”‚ å¤±è´¥é‡è¯•ï¼Œå°è¯•å…¶ä»–æä¾›è€…      â”‚
â”‚  failback    â”‚ å¤±è´¥è‡ªåŠ¨æ¢å¤ï¼Œåå°é‡è¯•         â”‚
â”‚  forking     â”‚ å¹¶è¡Œè°ƒç”¨å¤šä¸ªæä¾›è€…            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é…ç½®ç¤ºä¾‹ï¼š
@DubboReference(
    cluster = "failover",  // å¤±è´¥é‡è¯•
    retries = 2            // é‡è¯•2æ¬¡
)
```

---

## æ€»ç»“

### æ ¸å¿ƒè¦ç‚¹

1. **@DubboReference çš„ä½œç”¨**
   - è‡ªåŠ¨æ³¨å…¥è¿œç¨‹æœåŠ¡çš„ä»£ç†å¯¹è±¡
   - è®©è¿œç¨‹è°ƒç”¨çœ‹èµ·æ¥åƒæœ¬åœ°è°ƒç”¨

2. **å·¥ä½œæµç¨‹**
   - å¯åŠ¨æ—¶ï¼šä»æ³¨å†Œä¸­å¿ƒæŸ¥æ‰¾æœåŠ¡ â†’ åˆ›å»ºä»£ç†å¯¹è±¡ â†’ æ³¨å…¥åˆ°å­—æ®µ
   - è°ƒç”¨æ—¶ï¼šä»£ç†å¯¹è±¡æ‹¦æˆª â†’ åºåˆ—åŒ–å‚æ•° â†’ ç½‘ç»œä¼ è¾“ â†’ æ‰§è¡Œè¿œç¨‹æ–¹æ³• â†’ è¿”å›ç»“æœ

3. **å…³é”®ç»„ä»¶**
   - **æ³¨å†Œä¸­å¿ƒ**ï¼ˆNacosï¼‰ï¼šæœåŠ¡å‘ç°å’Œæ³¨å†Œ
   - **ä»£ç†å¯¹è±¡**ï¼šéšè—ç½‘ç»œé€šä¿¡ç»†èŠ‚
   - **åºåˆ—åŒ–**ï¼šå¯¹è±¡ â†” ç½‘ç»œæ ¼å¼è½¬æ¢

4. **ä¼˜åŠ¿**
   - âœ… è§£è€¦ï¼šæœåŠ¡ä¹‹é—´ç‹¬ç«‹éƒ¨ç½²
   - âœ… é€æ˜ï¼šä½¿ç”¨ç®€å•ï¼Œåƒæœ¬åœ°è°ƒç”¨
   - âœ… é«˜å¯ç”¨ï¼šæ”¯æŒè´Ÿè½½å‡è¡¡ã€å®¹é”™
   - âœ… å¯æ‰©å±•ï¼šæ˜“äºæ·»åŠ æ–°æœåŠ¡

### è®°å¿†å£è¯€

```
@DubboReference å¾ˆç®€å•ï¼Œ
æ³¨å…¥ä»£ç†å°±å®Œäº‹ã€‚
å¯åŠ¨æ—¶æ‰¾æ³¨å†Œä¸­å¿ƒï¼Œ
è°ƒç”¨æ—¶èµ°ç½‘ç»œä¼ è¾“ã€‚
çœ‹èµ·æ¥åƒæœ¬åœ°è°ƒç”¨ï¼Œ
å®é™…ä¸Šæ˜¯è¿œç¨‹ RPCã€‚
```

---

## æ‰©å±•é˜…è¯»

- [Dubbo å®˜æ–¹æ–‡æ¡£](https://dubbo.apache.org/zh/)
- [Nacos æ³¨å†Œä¸­å¿ƒ](https://nacos.io/)
- [RPC åŸç†è¯¦è§£](https://zh.wikipedia.org/wiki/é ç¨‹éç¨‹èª¿ç”¨)

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.0  
**æœ€åæ›´æ–°ï¼š** 2026-01-24  
**ä½œè€…ï¼š** AI Assistant
